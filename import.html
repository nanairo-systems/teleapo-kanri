<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“</text></svg>">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ - ãƒ†ãƒ¬ã‚¢ãƒé¡§å®¢ç®¡ç†</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<nav class="navbar">
  <div class="navbar-inner">
    <a href="index.html" class="navbar-brand"><span class="icon">ğŸ“</span>ãƒ†ãƒ¬ã‚¢ãƒé¡§å®¢ç®¡ç†</a>
    <button class="hamburger" id="hamburger"><span></span><span></span><span></span></button>
    <ul class="navbar-nav" id="navMenu">
      <li><a href="index.html">ğŸ  ãƒ›ãƒ¼ãƒ </a></li>
      <li><a href="import.html" class="active">ğŸ“¥ ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</a></li>
      <li id="navSettingsLi"><a href="settings.html">âš™ï¸ è¨­å®š</a></li>
      <li class="nav-user" id="navUserInfo"></li>
      <li><button class="btn-logout" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button></li>
    </ul>
  </div>
</nav>

<div class="loading-overlay" id="loading"><div class="spinner"></div></div>
<div class="toast-container" id="toastContainer"></div>

<div class="container" style="max-width:960px;">
  <div class="breadcrumb">
    <a href="index.html">ãƒ›ãƒ¼ãƒ </a><span>â€º</span><span>CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ</span>
  </div>

  <div class="page-header">
    <h1>ğŸ“¥ CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h1>
    <p>CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬ç™»éŒ²ã—ã¾ã™</p>
  </div>

  <!-- ã‚¹ãƒ†ãƒƒãƒ—è¡¨ç¤º -->
  <div class="step-indicator">
    <div class="step active" id="step1"><span class="step-num">1</span>ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ</div>
    <div class="step-line" id="line1"></div>
    <div class="step" id="step2"><span class="step-num">2</span>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç¢ºèª</div>
    <div class="step-line" id="line2"></div>
    <div class="step" id="step3"><span class="step-num">3</span>ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†</div>
  </div>

  <!-- ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ -->
  <div id="phase1">
    <div class="card">
      <div class="card-header"><h2>ğŸ“ ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ˆã®æ¥­å‹™ã‚’é¸æŠ</h2></div>
      <div class="card-body">
        <div class="form-group">
          <label>æ¥­å‹™<span class="required">*</span></label>
          <select id="businessSelect"></select>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header"><h2>ğŸ“„ CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</h2></div>
      <div class="card-body">
        <div class="drop-zone" id="dropZone">
          <input type="file" accept=".csv,.tsv,.txt" id="fileInput" onchange="handleFileSelect(event)">
          <div class="drop-zone-icon">ğŸ“„</div>
          <div class="drop-zone-text">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</div>
          <div class="drop-zone-hint">å¯¾å¿œå½¢å¼: CSVï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰ã€TSVï¼ˆã‚¿ãƒ–åŒºåˆ‡ã‚Šï¼‰/ UTF-8 æ¨å¥¨</div>
        </div>
        <div class="file-selected" id="fileSelected">
          <span>ğŸ“„</span>
          <span class="file-name" id="fileName"></span>
          <span class="file-size" id="fileSize"></span>
          <button class="file-remove" onclick="clearFile()">&times;</button>
        </div>
      </div>
    </div>

    <!-- åˆ—åã‚¬ã‚¤ãƒ‰ -->
    <div class="card">
      <div class="card-header">
        <h2>ğŸ“– ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</h2>
        <p>CSVãƒ•ã‚¡ã‚¤ãƒ«ã®1è¡Œç›®ã«ä»¥ä¸‹ã®åˆ—åã‚’å«ã‚ã¦ãã ã•ã„ã€‚åˆ—ã®é †ç•ªã¯è‡ªç”±ã§ã™ã€‚</p>
      </div>
      <div class="card-body">
        <div class="column-guide">
          <table>
            <thead><tr><th>åˆ—å</th><th>å¿…é ˆ</th><th>èª¬æ˜</th><th>ä¾‹</th></tr></thead>
            <tbody>
              <tr><td><strong>ä¼šç¤¾å</strong></td><td><span class="col-required">å¿…é ˆ</span></td><td>é¡§å®¢ã®ä¼šç¤¾åãƒ»å±‹å·</td><td>æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«</td></tr>
              <tr><td><strong>é›»è©±ç•ªå·</strong></td><td><span class="col-required">å¿…é ˆ</span></td><td>ãƒ¡ã‚¤ãƒ³ã®é›»è©±ç•ªå·</td><td>03-1234-5678</td></tr>
              <tr><td><strong>æ‹…å½“è€…å</strong></td><td><span class="col-optional">ä»»æ„</span></td><td>å…ˆæ–¹ã®æ‹…å½“è€…å</td><td>å±±ç”°å¤ªéƒ</td></tr>
              <tr><td><strong>éƒ¨ç½²å½¹è·</strong></td><td><span class="col-optional">ä»»æ„</span></td><td>æ‹…å½“è€…ã®éƒ¨ç½²ãƒ»å½¹è·</td><td>å–¶æ¥­éƒ¨ éƒ¨é•·</td></tr>
              <tr><td><strong>ãƒ¡ãƒ¼ãƒ«</strong></td><td><span class="col-optional">ä»»æ„</span></td><td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td><td>yamada@example.com</td></tr>
              <tr><td><strong>ä½æ‰€</strong></td><td><span class="col-optional">ä»»æ„</span></td><td>ä½æ‰€</td><td>æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3</td></tr>
              <tr><td><strong>å‚™è€ƒ</strong></td><td><span class="col-optional">ä»»æ„</span></td><td>ãƒ¡ãƒ¢ãƒ»å‚™è€ƒæ¬„</td><td>åˆå‰ä¸­ãŒç¹‹ãŒã‚Šã‚„ã™ã„</td></tr>
              <tr><td><strong>ã‚¿ã‚°</strong></td><td><span class="col-optional">ä»»æ„</span></td><td>ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°ã‚¿ã‚°æŒ‡å®šå¯èƒ½</td><td>è¦‹è¾¼ã¿é«˜,ææ–™ã‚ã‚Š</td></tr>
            </tbody>
          </table>
        </div>
        <div class="guide-note" style="margin-top: 16px;">
          <strong>ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ</strong><br>
          ãƒ»åˆ—åã¯1è¡Œç›®ã«è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚åˆ—ã®<strong>é †ç•ªã¯è‡ªç”±</strong>ã§ã™ã€‚<br>
          ãƒ»ã€Œä¼šç¤¾åã€ã¨ã€Œé›»è©±ç•ªå·ã€ã¯å¿…é ˆã§ã™ã€‚æœªå…¥åŠ›ã®è¡Œã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚<br>
          ãƒ»èªè­˜ã§ããªã„åˆ—åã¯ç„¡è¦–ã•ã‚Œã¾ã™ï¼ˆã‚¨ãƒ©ãƒ¼ã«ã¯ãªã‚Šã¾ã›ã‚“ï¼‰ã€‚<br>
          ãƒ»æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ UTF-8 ã‚’æ¨å¥¨ã—ã¾ã™ã€‚Shift_JIS ã‚‚è‡ªå‹•åˆ¤å®šã§å¯¾å¿œã—ã¾ã™ã€‚
        </div>
      </div>
    </div>
  </div>

  <!-- ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
  <div id="phase2" style="display:none;">
    <div class="card">
      <div class="card-header"><h2>ğŸ” åˆ—ãƒãƒƒãƒ”ãƒ³ã‚°çµæœ</h2></div>
      <div class="card-body">
        <div class="mapping-info" id="mappingInfo"></div>
      </div>
    </div>

    <div class="card">
      <div class="card-header"><h2>ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2></div>
      <div class="card-body">
        <div class="preview-stats" id="previewStats"></div>
        <div class="preview-wrapper">
          <table class="preview-table" id="previewTable"></table>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button class="btn btn-outline" onclick="goBack()">â† æˆ»ã‚‹</button>
      <button class="btn btn-success btn-lg" id="importBtn" onclick="executeImport()">ğŸ“¥ ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ</button>
    </div>
  </div>

  <!-- ã‚¹ãƒ†ãƒƒãƒ—3: å®Œäº† -->
  <div id="phase3" style="display:none;">
    <div class="result-banner" id="resultBanner">
      <div class="result-icon" id="resultIcon"></div>
      <div class="result-text" id="resultText"></div>
      <div class="result-detail" id="resultDetail"></div>
    </div>
    <div class="form-actions">
      <a href="index.html" class="btn btn-outline">ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
      <button class="btn btn-primary" onclick="resetAll()">ğŸ“¥ ç¶šã‘ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/supabase-api.js"></script>
<script>
  const KNOWN_COLUMNS = {
    'ä¼šç¤¾å': 'companyName', 'é›»è©±ç•ªå·': 'phone', 'æ‹…å½“è€…å': 'contactName',
    'éƒ¨ç½²å½¹è·': 'department', 'ãƒ¡ãƒ¼ãƒ«': 'email', 'ä½æ‰€': 'address',
    'å‚™è€ƒ': 'notes', 'ã‚¿ã‚°': 'tags'
  };
  const REQUIRED_COLS = ['ä¼šç¤¾å', 'é›»è©±ç•ªå·'];

  let parsedRows = [];
  let columnMapping = {};
  let validRows = [];


  // â”€â”€ èªè¨¼ãƒã‚§ãƒƒã‚¯ â”€â”€
  (function() {
    const a = JSON.parse(localStorage.getItem('authSession') || 'null');
    if (!a || Date.now() > a.expiry) { localStorage.removeItem('authSession'); location.replace('login.html'); }
  })();

  function logout() {
    if (confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ')) { localStorage.removeItem('authSession'); location.href = 'login.html'; }
  }

  document.addEventListener('DOMContentLoaded', async () => {
    const auth = JSON.parse(localStorage.getItem('authSession') || 'null');
    if (auth) {
      const el = document.getElementById('navUserInfo');
      if (el) el.textContent = `ğŸ‘¤ ${auth.name}`;
      if (auth.role !== 'admin') { const li = document.getElementById('navSettingsLi'); if (li) li.style.display = 'none'; }
    }
    await syncSettingsFromSupabase();
    populateBusinessSelect();
    setupDragDrop();
    document.getElementById('hamburger').addEventListener('click', () => {
      document.getElementById('navMenu').classList.toggle('open');
    });
  });

  function populateBusinessSelect() {
    const businesses = JSON.parse(localStorage.getItem('businesses') || '[]');
    const sel = document.getElementById('businessSelect');
    sel.innerHTML = '<option value="">-- æ¥­å‹™ã‚’é¸æŠ --</option>' +
      businesses.map(b => `<option value="${b.id}">${b.icon} ${b.name}</option>`).join('');
    const p = new URLSearchParams(window.location.search);
    if (p.get('businessId')) sel.value = p.get('businessId');
  }

  function setupDragDrop() {
    const dz = document.getElementById('dropZone');
    dz.addEventListener('dragover', e => { e.preventDefault(); dz.classList.add('dragover'); });
    dz.addEventListener('dragleave', () => dz.classList.remove('dragover'));
    dz.addEventListener('drop', e => {
      e.preventDefault(); dz.classList.remove('dragover');
      if (e.dataTransfer.files.length) processFile(e.dataTransfer.files[0]);
    });
  }

  function handleFileSelect(e) { if (e.target.files.length) processFile(e.target.files[0]); }

  function processFile(file) {
    if (!file.name.match(/\.(csv|tsv|txt)$/i)) { showToast('CSV/TSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error'); return; }
    document.getElementById('fileName').textContent = file.name;
    document.getElementById('fileSize').textContent = formatSize(file.size);
    document.getElementById('fileSelected').classList.add('show');

    const reader = new FileReader();
    reader.onload = e => {
      let text = e.target.result;
      if (text.charCodeAt(0) === 0xFEFF) text = text.slice(1);
      parseCSV(text, file.name.endsWith('.tsv') ? '\t' : ',');
    };
    reader.readAsText(file, 'UTF-8');
  }

  function clearFile() {
    document.getElementById('fileInput').value = '';
    document.getElementById('fileSelected').classList.remove('show');
    parsedRows = [];
    columnMapping = {};
  }

  function parseCSV(text, delimiter) {
    const lines = text.split(/\r?\n/).filter(l => l.trim());
    if (lines.length < 2) { showToast('ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼‹1è¡Œä»¥ä¸Šå¿…è¦ï¼‰', 'error'); return; }

    const headers = parseCSVLine(lines[0], delimiter).map(h => h.trim());
    columnMapping = {};
    headers.forEach((h, i) => {
      const mapped = KNOWN_COLUMNS[h];
      if (mapped) columnMapping[i] = { original: h, field: mapped };
    });

    parsedRows = [];
    for (let i = 1; i < lines.length; i++) {
      const cols = parseCSVLine(lines[i], delimiter);
      const row = { _raw: cols, _errors: [] };
      for (const [idx, map] of Object.entries(columnMapping)) {
        row[map.field] = (cols[parseInt(idx)] || '').trim();
      }
      if (!row.companyName) row._errors.push('ä¼šç¤¾åãŒç©º');
      if (!row.phone) row._errors.push('é›»è©±ç•ªå·ãŒç©º');
      parsedRows.push(row);
    }
    showPreview(headers);
  }

  function parseCSVLine(line, delimiter) {
    const result = []; let current = ''; let inQuote = false;
    for (let i = 0; i < line.length; i++) {
      const ch = line[i];
      if (inQuote) {
        if (ch === '"' && line[i + 1] === '"') { current += '"'; i++; }
        else if (ch === '"') inQuote = false;
        else current += ch;
      } else {
        if (ch === '"') inQuote = true;
        else if (ch === delimiter) { result.push(current); current = ''; }
        else current += ch;
      }
    }
    result.push(current);
    return result;
  }

  function showPreview(headers) {
    if (!document.getElementById('businessSelect').value) {
      showToast('å…ˆã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ˆã®æ¥­å‹™ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error'); return;
    }

    setStep(2);
    document.getElementById('phase1').style.display = 'none';
    document.getElementById('phase2').style.display = '';

    const mappingEl = document.getElementById('mappingInfo');
    const allKnown = Object.keys(KNOWN_COLUMNS);
    const mappedNames = Object.values(columnMapping).map(m => m.original);
    const unmappedHeaders = headers.filter(h => !KNOWN_COLUMNS[h]);

    mappingEl.innerHTML =
      mappedNames.map(n => `<span class="mapping-chip matched">âœ“ ${n}</span>`).join('') +
      allKnown.filter(k => !mappedNames.includes(k)).map(k =>
        `<span class="mapping-chip ${REQUIRED_COLS.includes(k) ? 'missing' : 'extra'}">âœ— ${k}${REQUIRED_COLS.includes(k) ? 'ï¼ˆå¿…é ˆï¼‰' : ''}</span>`
      ).join('') +
      unmappedHeaders.map(h => `<span class="mapping-chip extra">? ${h}ï¼ˆç„¡è¦–ï¼‰</span>`).join('');

    const missingReq = REQUIRED_COLS.filter(r => !mappedNames.includes(r));
    if (missingReq.length) {
      showToast(`å¿…é ˆåˆ—ã€Œ${missingReq.join('ã€ã€Œ')}ã€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`, 'error');
      document.getElementById('importBtn').disabled = true;
    } else {
      document.getElementById('importBtn').disabled = false;
    }

    validRows = parsedRows.filter(r => r._errors.length === 0);
    const errorRows = parsedRows.filter(r => r._errors.length > 0);

    document.getElementById('previewStats').innerHTML = `
      <div class="stat"><span class="stat-dot dot-ok"></span>æœ‰åŠ¹: ${validRows.length}ä»¶</div>
      <div class="stat"><span class="stat-dot dot-err"></span>ã‚¨ãƒ©ãƒ¼: ${errorRows.length}ä»¶</div>
      <div class="stat">åˆè¨ˆ: ${parsedRows.length}ä»¶</div>
    `;

    const displayCols = Object.values(columnMapping).map(m => m.original);
    const pt = document.getElementById('previewTable');
    const maxPreview = Math.min(parsedRows.length, 100);
    pt.innerHTML = `<thead><tr><th>#</th><th>çŠ¶æ…‹</th>${displayCols.map(c => `<th>${c}</th>`).join('')}</tr></thead>
      <tbody>${parsedRows.slice(0, maxPreview).map((r, i) => {
        const hasErr = r._errors.length > 0;
        return `<tr class="${hasErr ? 'row-error' : ''}"><td>${i + 1}</td><td>${hasErr ? 'âŒ' : 'âœ…'}</td>${
          Object.values(columnMapping).map(m => {
            const val = r[m.field] || '';
            const isErrField = REQUIRED_COLS.includes(m.original) && !val;
            return `<td class="${isErrField ? 'cell-error' : ''}">${esc(val || '-')}</td>`;
          }).join('')}</tr>`;
      }).join('')}</tbody>`;
    if (parsedRows.length > maxPreview) {
      pt.innerHTML += `<tfoot><tr><td colspan="${displayCols.length + 2}" style="text-align:center;padding:12px;color:var(--gray-400);">ä»– ${parsedRows.length - maxPreview}ä»¶ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼çœç•¥ï¼‰</td></tr></tfoot>`;
    }
  }

  function goBack() {
    setStep(1);
    document.getElementById('phase1').style.display = '';
    document.getElementById('phase2').style.display = 'none';
  }

  async function executeImport() {
    if (validRows.length === 0) { showToast('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“', 'error'); return; }

    const businessId = document.getElementById('businessSelect').value;
    const customers = validRows.map(r => ({
      businessId,
      companyName: r.companyName || '',
      contactName: r.contactName || '',
      department:  r.department  || '',
      phone:       r.phone       || '',
      email:       r.email       || '',
      address:     r.address     || '',
      notes:       r.notes       || '',
      tags:        r.tags        || '',
    }));

    showLoading(true);
    try {
      const result = await apiBulkImport(customers);
      showResult(true, result.imported || customers.length);
    } catch(e) {
      showResult(false, 0, e.message);
    } finally {
      showLoading(false);
    }
  }

  function showResult(success, count, errorMsg) {
    setStep(3);
    document.getElementById('phase2').style.display = 'none';
    document.getElementById('phase3').style.display = '';

    const banner = document.getElementById('resultBanner');
    banner.className = `result-banner ${success ? 'success' : 'error'}`;
    document.getElementById('resultIcon').textContent = success ? 'ğŸ‰' : 'âŒ';
    document.getElementById('resultText').textContent = success ? 'ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†ï¼' : 'ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¤±æ•—';
    document.getElementById('resultDetail').textContent = success
      ? `${count}ä»¶ã®é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ`
      : `ã‚¨ãƒ©ãƒ¼: ${errorMsg}`;
  }

  function resetAll() {
    setStep(1);
    document.getElementById('phase1').style.display = '';
    document.getElementById('phase2').style.display = 'none';
    document.getElementById('phase3').style.display = 'none';
    clearFile();
    parsedRows = []; columnMapping = {}; validRows = [];
  }

  function setStep(n) {
    for (let i = 1; i <= 3; i++) {
      const el = document.getElementById(`step${i}`);
      el.className = 'step' + (i < n ? ' done' : i === n ? ' active' : '');
    }
    document.getElementById('line1').className = 'step-line' + (n > 1 ? ' done' : '');
    document.getElementById('line2').className = 'step-line' + (n > 2 ? ' done' : '');
  }

  function formatSize(bytes) {
    if (bytes < 1024) return bytes + ' B';
    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
    return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
  }
  function esc(s) { if (!s) return ''; const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }
  function showLoading(v) { document.getElementById('loading').classList.toggle('show', v); }
  function showToast(msg, type = 'success') {
    const c = document.getElementById('toastContainer'); const t = document.createElement('div'); t.className = `toast ${type}`;
    t.innerHTML = `<span>${type==='success'?'âœ…':'âŒ'}</span> ${esc(msg)}`;
    c.appendChild(t); setTimeout(() => { t.style.opacity = '0'; t.style.transition = 'opacity 0.3s'; setTimeout(() => t.remove(), 300); }, 4000);
  }
</script>

</body>
</html>
